#include <rclcpp/rclcpp.hpp>
#include <visualization_msgs/msg/marker.hpp>
#include <cmath>
#include <vector>

using namespace std::chrono_literals;
class RoadPublisherNode : public rclcpp::Node {
public:
    RoadPublisherNode() : Node("road_publisher_node") {
        publisher_ = this->create_publisher<visualization_msgs::msg::Marker>("road_visualization_marker", 10);
        timer_ = this->create_wall_timer(500ms, std::bind(&RoadPublisherNode::publishRoadMarkers, this));
    }

private:
    void publishRoadMarkers() {
        std::vector<std::tuple<std::array<double, 3>, std::array<double, 3>>> roads = {
            {{-48.7, -103.7, 0.22}, {-48.7, 104.2, 0.22}},

            {{-41.3, -95.8, 0.22}, {-41.3, -49.2, 0.22}},
            {{-41.3, -40.8, 0.22}, {-41.3, -4.2, 0.22}},
            {{-41.3, 4.2, 0.22}, {-41.3, 40.8, 0.22}},
            {{-41.3, 49.2, 0.22}, {-41.3, 95.8, 0.22}},

            {{-18.7, -95.8, 0.22}, {-18.7, -49.2, 0.22}},
            {{-18.7, -40.8, 0.22}, {-18.7, -4.2, 0.22}},
            {{-18.7, 4.2, 0.22}, {-18.7, 40.8, 0.22}},
            {{-18.7, 49.2, 0.22}, {-18.7, 95.8, 0.22}},

            {{-11.3, -95.8, 0.22}, {-11.3, -49.2, 0.22}},
            {{-11.3, -40.8, 0.22}, {-11.3, -4.2, 0.22}},
            {{-11.3, 4.2, 0.22}, {-11.3, 40.8, 0.22}},
            {{-11.3, 49.2, 0.22}, {-11.3, 95.8, 0.22}},

            {{41.3, -95.8, 0.22}, {41.3, -49.2, 0.22}},
            {{41.3, -40.8, 0.22}, {41.3, -4.2, 0.22}},
            {{41.3, 4.2, 0.22}, {41.3, 40.8, 0.22}},
            {{41.3, 49.2, 0.22}, {41.3, 95.8, 0.22}},

            {{48.7, -95.8, 0.22}, {48.7, -49.2, 0.22}},
            {{48.7, -40.8, 0.22}, {48.7, -4.2, 0.22}},
            {{48.7, 4.2, 0.22}, {48.7, 40.8, 0.22}},
            {{48.7, 49.2, 0.22}, {48.7, 95.8, 0.22}},

            {{106.3, -95.8, 0.22}, {106.3, -49.2, 0.22}},
            {{106.3, -40.8, 0.22}, {106.3, -4.2, 0.22}},
            {{106.3, 4.2, 0.22}, {106.3, 40.8, 0.22}},
            {{106.3, 49.2, 0.22}, {106.3, 95.8, 0.22}},

            {{113.7, -95.8, 0.22}, {113.7, -49.2, 0.22}},
            {{113.7, -40.8, 0.22}, {113.7, -4.2, 0.22}},
            {{113.7, 4.2, 0.22}, {113.7, 40.8, 0.22}},
            {{113.7, 49.2, 0.22}, {113.7, 95.8, 0.22}},

            {{116.3, -95.8, 0.22}, {116.3, -49.2, 0.22}},
            {{116.3, -40.8, 0.22}, {116.3, -4.2, 0.22}},
            {{116.3, 4.2, 0.22}, {116.3, 40.8, 0.22}},
            {{116.3, 49.2, 0.22}, {116.3, 95.8, 0.22}},

            {{123.7, -103.7, 0.22}, {123.7, 104.2, 0.22}},





            {{-48.7, -104.2, 0.225}, {123.7, -104.2, 0.225}},

            {{-41.3, -95.8, 0.225}, {-18.7, -95.8, 0.225}},
            {{-11.3, -95.8, 0.225}, {41.3, -95.8, 0.225}},
            {{48.7, -95.8, 0.225}, {106.3, -95.8, 0.225}},
            {{113.7, -95.8, 0.225}, {116.3, -95.8, 0.225}},

            {{-41.3, -49.2, 0.225}, {-18.7, -49.2, 0.225}},
            {{-11.3, -49.2, 0.225}, {41.3, -49.2, 0.225}},
            {{48.7, -49.2, 0.225}, {106.3, -49.2, 0.225}},
            {{113.7, -49.2, 0.225}, {116.3, -49.2, 0.225}},

            {{-41.3, -40.8, 0.225}, {-18.7, -40.8, 0.225}},
            {{-11.3, -40.8, 0.225}, {41.3, -40.8, 0.225}},
            {{48.7, -40.8, 0.225}, {106.3, -40.8, 0.225}},
            {{113.7, -40.8, 0.225}, {116.3, -40.8, 0.225}},

            {{-41.3, -4.2, 0.225}, {-18.7, -4.2, 0.225}},
            {{-11.3, -4.2, 0.225}, {41.3, -4.2, 0.225}},
            {{48.7, -4.2, 0.225}, {106.3, -4.2, 0.225}},
            {{113.7, -4.2, 0.225}, {116.3, -4.2, 0.225}},

            {{-41.3, 4.2, 0.225}, {-18.7, 4.2, 0.225}},
            {{-11.3, 4.2, 0.225}, {41.3, 4.2, 0.225}},
            {{48.7, 4.2, 0.225}, {106.3, 4.2, 0.225}},
            {{113.7, 4.2, 0.225}, {116.3, 4.2, 0.225}},

            {{-41.3, 40.8, 0.225}, {-18.7, 40.8, 0.225}},
            {{-11.3, 40.8, 0.225}, {41.3, 40.8, 0.225}},
            {{48.7, 40.8, 0.225}, {106.3, 40.8, 0.225}},
            {{113.7, 40.8, 0.225}, {116.3, 40.8, 0.225}},

            {{-41.3, 49.2, 0.225}, {-18.7, 49.2, 0.225}},
            {{-11.3, 49.2, 0.225}, {41.3, 49.2, 0.225}},
            {{48.7, 49.2, 0.225}, {106.3, 49.2, 0.225}},
            {{113.7, 49.2, 0.225}, {116.3, 49.2, 0.225}},

            {{-41.3, 95.8, 0.225}, {-18.7, 95.8, 0.225}},
            {{-11.3, 95.8, 0.225}, {41.3, 95.8, 0.225}},
            {{48.7, 95.8, 0.225}, {106.3, 95.8, 0.225}},
            {{113.7, 95.8, 0.225}, {116.3, 95.8, 0.225}},

            {{-48.7, 104.2, 0.225}, {123.7, 104.2, 0.225}},

        };

        visualization_msgs::msg::Marker marker;
        marker.header.frame_id = "odom";
        marker.header.stamp = this->get_clock()->now();
        marker.ns = "roads";
        marker.id = 0;
        marker.type = visualization_msgs::msg::Marker::LINE_LIST;
        marker.action = visualization_msgs::msg::Marker::ADD;
        marker.scale.x = 0.5; // Line width
        marker.color.a = 1.0; // Alpha
        marker.color.r = 0.0; 
        marker.color.g = 0.0;
        marker.color.b = 1.0;

        for (const auto& road : roads) {
            auto& [start, end] = road;
            marker.points.push_back(createPoint(start[0], start[1], start[2]));
            marker.points.push_back(createPoint(end[0], end[1], end[2]));
        }

        publisher_->publish(marker);
    }

    geometry_msgs::msg::Point createPoint(double x, double y, double z) {
        geometry_msgs::msg::Point point;
        point.x = x;
        point.y = y;
        point.z = z;
        return point;
    }

    rclcpp::Publisher<visualization_msgs::msg::Marker>::SharedPtr publisher_;
    rclcpp::TimerBase::SharedPtr timer_;
};

int main(int argc, char** argv) {
    rclcpp::init(argc, argv);
    auto node = std::make_shared<RoadPublisherNode>();
    rclcpp::spin(node);
    rclcpp::shutdown();
    return 0;
}
